- hosts: unicorn
  tasks:
    - name: install package unzip
      become: true
      apt:
        name:
          - zip
          - unzip
        state: present
    - name: create folder
      become: true
      file:
        path: "/home/workshop/hello"
        state: directory
        owner: workshop
        group: workshop
    - name: download zip file
      get_url:
        url: https://github.com/trietphm/workshop-rails-vue/releases/download/v0.1/hello-world.zip
        dest: /tmp/hello-world.zip
    - name: unzip file
      become: true
      unarchive:
        src: /tmp/hello-world.zip
        dest: /home/workshop/hello
        remote_src: yes
    - name: execute binary file
      command: "./hello-world"
      args:
        chdir: /home/workshop/hello
      register: hello_world_message
    - name: execute binary file with env keys
      command: "./hello-world"
      args:
        chdir: /home/workshop/hello
      register: cow_message
      environment:
        COW: "true"
        MESSAGE: "Hello guys!"
    - name: debug
      debug:
        msg: "{{ hello_world_message }}"
    - name: write variable to file
      become: true
      copy:
        content: "{{ hello_world_message.stdout }}\n{{ cow_message.stdout }}"
        dest: /home/workshop/hello/messages.txt



